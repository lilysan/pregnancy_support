<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weight | Pregnancy Support</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
</head>
<body>
<h1>Weight</h1>
<div id="lang"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
    liff.init({
        liffId: '2005594923-wN8OjyGd', // Use own liffId
        withLoginOnExternalBrowser: true, // Enable automatic login process
    }).then(() => {
        // Start to use liff's api
        const idToken = liff.getIDToken();
        getLanguage(idToken);
    }).catch((err) => {
        // Error happens during initialization
        liff.logout();
    });

    function getLanguage(idToken){
        console.log(idToken);
        const data = {
            path: "lang",
            method : "get",
            postData: {
                idToken: idToken
            }
        };
        $.ajax({
            url: "https://script.google.com/macros/s/AKfycbyUUS9qijnORQTAxUzVXLlsDigodcNn-uANaFjQpiRXqS5mQcIFlNRWYerSkzELOc5d/exec",
            type:'POST',
            dataType: 'json',
            data: JSON.stringify(data),
            timeout: 10000,
        }).done(function(data) {
            if(data.statusCode !== 200){
                console.error(data.message);
                liff.logout();
            }
            else {
                $("#lang").html(data.data.lang);
            }
        }).fail(function(XMLHttpRequest, textStatus, errorThrown) {
            liff.logout();
        })

    }

</script>
</body>
</html>